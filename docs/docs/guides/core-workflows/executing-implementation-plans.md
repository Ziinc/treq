---
sidebar_position: 3
---

# Executing Implementation Plans

Learn how to use Treq's AI-powered implementation plan system to guide your development workflow.

This guide covers:
- Understanding implementation plans in Treq
- Creating and editing plans
- Executing plans to create worktrees
- Managing plan history
- Best practices for plan-driven development

- **Prerequisites**: Treq installed, familiarity with terminal sessions

## Understanding Implementation Plans

### What are Implementation Plans?

An **implementation plan** is a structured document that outlines:
- Design approach and architecture decisions
- Step-by-step implementation tasks
- Code examples and commands to run
- Testing strategies and acceptance criteria

Plans are typically generated by AI assistants (like Claude) but can also be written manually.

**Why use plans?**
- Break down complex features into manageable steps
- Document your approach before coding
- Track progress through implementation
- Share plans with team members
- Resume work easily after interruptions

### Plan Structure

Treq recognizes several plan section types:

**`## Plan`**: Overall design and approach
**`## Implementation Plan`**: Step-by-step implementation tasks
**`## Tasks`**: Specific actionable tasks
**`## Suggestions`**: Optional improvements or alternatives

Example plan structure:
```markdown
## Plan
Create a user authentication system using JWT tokens...

## Implementation Plan
1. Set up authentication middleware
2. Create login/logout endpoints
3. Implement token generation and validation
4. Add protected route middleware

## Tasks
- [ ] Install jsonwebtoken package
- [ ] Create auth utility functions
- [ ] Write unit tests for auth logic
```

## Creating an Implementation Plan

### Method 1: AI-Generated Plans

The most common workflow uses an AI assistant:

**Step 1: Describe Your Task**

In a terminal or IDE with AI assistance, describe what you want to build:

```
"I need to add user authentication to my Express.js API using JWT tokens.
Include login, logout, token refresh, and protected routes."
```

**Step 2: Receive the Plan**

The AI generates a detailed implementation plan with sections like:

```markdown
## Implementation Plan

### 1. Dependencies and Setup
Install required packages...

### 2. Create Authentication Middleware
Implement JWT verification middleware...

### 3. User Login Endpoint
Create POST /api/auth/login endpoint...
```

**Step 3: Copy to Treq**

Copy the plan text and paste it into Treq's plan editor (coming up next).

### Method 2: Manual Plan Creation

Write your own plan manually:

1. Open a text editor or Treq's plan panel
2. Write your plan using markdown
3. Include clear sections and actionable steps
4. Add code examples where helpful

### Method 3: Load from File

Import a previously saved plan:

1. Open plan history dialog
2. Select a past plan
3. Or drag-and-drop a `.md` file into Treq

## The Plan Panel

### Accessing the Plan Panel

The plan panel appears at the bottom of terminal sessions:

<!-- ![Plan panel](./images/plans-panel.png) -->
*The plan panel shows your implementation plan below the terminal*

**To show/hide**:
- Click the **"Plan"** button in the terminal toolbar
- Or press `Cmd+Shift+P` / `Ctrl+Shift+P`

### Plan Panel Features

**Display Mode**:
- Formatted markdown rendering
- Syntax highlighting for code blocks
- Collapsible sections for long plans
- Line numbers for reference

**Editing Mode**:
- Click **"Edit"** to modify the plan
- Full markdown support
- Auto-save as you type
- Preview updates in real-time

**Actions**:
- **Execute**: Create new worktree from this plan
- **Save**: Add plan to history
- **Copy**: Copy plan to clipboard
- **Clear**: Remove plan from view

## Executing a Plan

### What Does "Execute" Mean?

When you execute a plan, Treq:
1. Creates a new worktree for implementing the plan
2. Sets the plan title as the worktree metadata
3. Opens a terminal session in the new worktree
4. Displays the plan in the plan panel
5. You're ready to start implementing!

### Step-by-Step Execution

**Step 1: Paste Your Plan**

In any terminal session:
1. Click the plan panel to focus it
2. Click **"Edit"**
3. Paste your plan content
4. Click **"Done"** to save

**Step 2: Review the Plan**

Read through the plan to:
- Understand the overall approach
- Identify dependencies or prerequisites
- Note any questions or concerns

**Step 3: Execute the Plan**

1. Click **"Execute Plan"** button
2. Treq shows the "Create Worktree" dialog pre-filled with:
   - Branch name (derived from plan title)
   - Plan title for metadata
   - User intent (extracted from plan)

<!-- ![Execute plan dialog](./images/plans-execute-dialog.png) -->
*The execute dialog pre-fills information from your plan*

**Step 4: Confirm Worktree Creation**

1. Review or adjust the branch name
2. Select base branch (usually `main`)
3. Click **"Create"**

**Step 5: Start Implementing**

The new worktree opens with:
- Terminal ready for commands
- Plan visible in the plan panel
- Working directory set to worktree path

Now follow your plan step-by-step!

## Working with Plans During Implementation

### Following Your Plan

Use the plan as your guide:

**Check Off Tasks**:
- As you complete steps, mentally or physically check them off
- Edit the plan to add ✓ or mark completed

**Add Notes**:
- Document decisions or deviations
- Add links to resources you used
- Note any issues encountered

**Update as Needed**:
- Plans are living documents
- Adjust steps based on what you discover
- Add new tasks if needed

### Executing Commands from Plans

Plans often include commands to run:

```markdown
## Implementation Plan

### Step 1: Install Dependencies
Run: `npm install jsonwebtoken bcrypt`

### Step 2: Create Middleware
Run: `touch src/middleware/auth.js`
```

**Copy and execute**:
1. Copy command from plan
2. Paste into terminal
3. Press Enter
4. Verify output matches expectations

### Splitting Complex Plans

For large plans, consider:

**Creating Multiple Worktrees**:
- One per major section or milestone
- Allows parallel progress
- Merge incrementally

**Checkpoints**:
- Commit after each major step
- Tag commits with step numbers
- Easy to review progress

## Plan History

### Saving Plans

Treq automatically saves plans when you:
- Execute a plan (create worktree from it)
- Manually click **"Save"**
- Create a commit with an active plan

Saved plans are stored in:
- `.treq/plans/{uuid}.md` (plan content)
- `.treq/plans/{uuid}.json` (metadata)

### Viewing Plan History

Access past plans:

1. Open plan history dialog (button in plan panel)
2. Browse plans by date or search
3. Click a plan to load it

<!-- ![Plan history](./images/plans-history.png) -->
*Plan history shows all saved plans with search and filters*

**Metadata shown**:
- Plan title and description
- Creation date and time
- Associated worktree (if executed)
- Status (completed, in-progress, abandoned)

### Reusing Plans

Load a previous plan to:
- Execute it again for a similar task
- Use as a template for new work
- Reference past approaches
- Share with team members

**To reuse**:
1. Open plan history
2. Select the plan
3. Click **"Load"**
4. Edit as needed for new context
5. Execute to create new worktree

## Plan-Driven Development Workflow

### End-to-End Example

Let's walk through a complete workflow:

**1. Get Assignment**
```
"Add pagination to the user list API endpoint"
```

**2. Generate Plan** (via AI)
```markdown
## Plan
Add pagination support to GET /api/users endpoint using
offset/limit query parameters...

## Implementation Plan
1. Add pagination query parameter validation
2. Update database query to support LIMIT and OFFSET
3. Modify response to include pagination metadata
4. Update API documentation
5. Add tests for pagination logic

## Acceptance Criteria
- GET /api/users?limit=10&offset=0 returns first 10 users
- Response includes total_count, limit, offset
- Invalid parameters return 400 error
```

**3. Execute Plan in Treq**
- Paste plan into plan panel
- Click "Execute"
- Create worktree: `treq/add-user-pagination`

**4. Implement Step-by-Step**
```bash
# Step 1: Validation
vi src/validators/pagination.js
# ... implement validation ...

# Step 2: Update query
vi src/models/User.js
# ... add pagination logic ...

# Step 3: Modify response
vi src/controllers/userController.js
# ... add metadata ...

# Commit progress
git add .
git commit -m "feat: add pagination to user list endpoint"
```

**5. Test and Review**
```bash
# Run tests
npm test

# Manual testing
curl "http://localhost:3000/api/users?limit=5&offset=0"
```

**6. Merge Back to Main**
- Use Treq's merge functionality
- Review changes one more time
- Complete the merge

### Iterating on Plans

Plans rarely survive first contact perfectly:

**Expected Changes**:
- Discover additional steps needed
- Find better approaches mid-implementation
- Encounter unexpected issues

**How to Handle**:
1. Pause and update the plan
2. Add notes about what changed
3. Adjust remaining steps
4. Continue with updated plan

**Plan Versioning**:
- Save major iterations
- Name them descriptively
- Reference previous versions in notes

## Collaboration with Plans

### Sharing Plans

Plans are portable and shareable:

**Option 1: Git Repository**
```bash
# Commit plan to repo (not in .treq)
mkdir docs/plans
cp .treq/plans/feature-auth.md docs/plans/
git add docs/plans/feature-auth.md
git commit -m "docs: add authentication implementation plan"
```

**Option 2: External Systems**
- Copy/paste to Notion, Confluence, etc.
- Share via Slack or email
- Store in project management tools

**Option 3: Code Review**
- Include plan in PR description
- Reviewers see implementation approach
- Easier to review against plan

### Team Plan Templates

Create reusable plan templates for common tasks:

**Template: New API Endpoint**
```markdown
## Plan
Create [ENDPOINT_NAME] API endpoint for [PURPOSE].

## Implementation Plan
1. Define endpoint route and HTTP method
2. Create request/response schemas
3. Implement handler function
4. Add input validation
5. Write tests (unit + integration)
6. Update API documentation

## Checklist
- [ ] OpenAPI spec updated
- [ ] Error handling implemented
- [ ] Tests passing
- [ ] Documentation reviewed
```

Store templates in your repository for consistency.

## Advanced Plan Features

### Plan Metadata

Plans store metadata for organization:

- **Title**: Brief description
- **Intent**: User's original request
- **Status**: In progress, completed, abandoned
- **Tags**: Categorization (feature, bugfix, refactor)
- **Related Issues**: Link to GitHub issues or tickets

### Plan Search

Find plans quickly:

1. Open plan history
2. Use search bar to filter by:
   - Title or content keywords
   - Date range
   - Status
   - Associated worktree

### Plan Export/Import

**Export**:
- Click **"Export"** in plan history
- Choose format (Markdown, JSON)
- Save to disk

**Import**:
- Drag-and-drop `.md` file into plan panel
- Or use **"Import"** button
- Plan loads and is ready to execute

## Best Practices

1. **Write Clear Plans**: Be specific about what needs to be done
2. **Break Down Large Tasks**: Split into smaller, manageable steps
3. **Include Code Examples**: Makes implementation faster
4. **Update Plans as You Go**: Document deviations and learnings
5. **Save Important Plans**: Build a library of approaches
6. **Review Before Executing**: Ensure plan makes sense
7. **Use Plans for Code Review**: Share your approach with reviewers
8. **Version Control Plans**: Keep plan history for reference

## Troubleshooting

### Plan Not Parsing Correctly

**Cause**: Markdown formatting issues.

**Solution**:
- Check section headers use `##`
- Ensure proper code block formatting
- Validate markdown syntax

### Can't Execute Plan

**Cause**: No plan loaded or missing required sections.

**Solution**:
- Ensure plan is in the plan panel
- Check that plan has a title or intent
- Try editing plan to add missing info

### Plan Panel Not Showing

**Cause**: Panel hidden or terminal view issue.

**Solution**:
- Click "Plan" button in toolbar
- Try closing and reopening terminal session
- Check Settings → Interface → Panels

## Next Steps

With implementation plans mastered:

- [**Staging and Committing**](staging-and-committing) - Commit your plan progress
- [**Code Review Workflow**](code-review-workflow) - Share plans in reviews
- [**Merging Worktrees**](merging-worktrees) - Merge completed plan work
